#ifndef HF_H
#define HF_H

// calibrate
// static const float hfofficial[21] = {
//   0.00, 17.2431, 26.9139, 41.7487, 64.6255,
//   98.4899, 145.929, 212.995, 302.033, 420.98,
//   572.691, 757.839, 984.587, 1259.79, 1585.96,
//   1971.74, 2426.69, 2953.19, 3594.04, 4391,
//   20000
// };

static const float hfofficial[21] = {
  0.00, 17.6001, 28.0002, 44.3275, 70.1453,
  107.436, 158.482, 228.183, 321.58, 443.515,
  597.882, 786.092, 1015.35, 1293.06, 1619.6,
  2005.38, 2455.56, 2978.33, 3613.65, 4405.07,
  20000
};

// // pre-approval
// static const float hfofficial[21] = {
//   0.00, 21.912, 32.922, 48.1319, 74.5685,
//   109.254, 160.135, 229.354, 324.242, 448.531,
//   613, 807.912, 1022.78, 1295.83, 1622.63,
//   2022.31, 2477.43, 3022.03, 3615.86, 4440.5,
//   20000
// };

// 2Th4
// static const float hfofficial[21] = {
//   0.00, 19.6214, 28.9009, 43.1307, 65.0945,
//   98.4961, 145.579, 210.631, 299.593, 417.632,
//   576.312, 776.68, 990.303, 1260.25, 1577.85,
//   1991.96, 2450.84, 3003.23, 3589.07, 4428.49,
//   20000
// };

static const float hfeffdown[21] = {
  0.00, 17.6276, 28.2182, 44.6453, 68.6864,
  102.371, 151.295, 219.48, 310.18, 430.492,
  583.213, 769.753, 997.907, 1273.3, 1600.32,
  1985.63, 2439.07, 2964.28, 3602.78, 4397.11,
  20000
};

static const float hfeffup[21] = {
  0.00, 17.538, 27.9164, 43.4104, 67.9751,
  105.242, 159.526, 235.057, 336.343, 460.861,
  618.154, 808.837, 1038.15, 1317.15, 1643.82,
  2029.38, 2478.37, 2998.23, 3631.72, 4416.03,
  20000
};

// static const float hfeffup[21] = {
//   0.00, 17.2291, 26.9584, 41.3465, 63.481,
//   97.1741, 145.781, 213.34, 305.717, 425.257,
//   577.531, 763.22, 990.442, 1266.4, 1592.69,
//   1977.56, 2432.26, 2958.12, 3598.52, 4393.74,
//   20000
// };

// static const float hfeffdown[21] = {
//   0.00, 17.1875, 26.9746, 41.7275, 64.0497,
//   96.2875, 142.93, 209.466, 297.538, 415.279,
//   566.393, 751.226, 976.998, 1252.36, 1578.4,
//   1964.26, 2418.94, 2946.77, 3588.57, 4387.29,
//   20000
// };



/* CentralityTable_HFtowers200_DataXeXe_eff95_run2v941x02_offline */
// static const float hfofficial[21] = {
//         0.00, 13.2348, 18.7674, 27.4916, 40.5531,
//      59.3048, 85.5337, 121.442,   169.9, 233.563,
//      314.095,  414.83, 538.815, 686.084, 862.823,
//      1071.18, 1317.78, 1610.02, 1961.63, 2394.33,
//     20000.00
// };

// static const float hfeffup[21] = {
//   0.00, 17.6382, 23.7497, 34.2277, 49.7004,
//   71.2325, 100.793, 140.552, 193.142, 260.808,
//   345.225,     449, 574.858, 724.443, 900.748,
//   1109.4, 1353.88, 1641.79, 1987.47, 2410.48,
//   20000.00
// };

// static const float hfeffdown[21] = {
//   0.00,  15.929, 19.4426, 23.7154,  33.661,
//   50.1023, 73.4304, 106.172, 150.959, 210.843,
//   288.199, 385.384, 506.484, 652.586, 828.802,
//   1037.42, 1285.74, 1581.93, 1938.88, 2380.16,
//   20000.00
// };

// static const float hfepos[21] = {
//   0.00, 18.7814, 28.305, 44.129, 68.074,
//   100.128, 143.734, 207.103, 287.601, 390.991,
//   515.059, 671.963, 853.61, 1086.8, 1372.18,
//   1701.7, 2133.49, 2655.34, 3326.74, 4164.71,
//   20000
// };
static const float hfepos[21] = {
0.00, 15.2843, 22.0405, 34.3438, 55.0719,
84.6078, 124.061, 183.287, 260.844, 355.636,
478.795, 623.79, 807.357, 1038.11, 1325.14,
1653.56, 2069.93, 2579.5, 3263.03, 4133.21,
20000
};

// static const float hfhydjet[21] = {
//   0.00, 19.9523, 31.2677, 48.6755, 75.4035,
//   115.465, 171.874, 253.675, 360.65, 499.321,
//   677.377, 891.863, 1152.75, 1471.26, 1854.3,
//   2291.85, 2819.15, 3428.58, 4171.97, 5080.39,
//   20000
// };
static const float hfhydjet[21] = {
0.00, 19.646, 30.7881, 46.5723, 72.3133,
111.328, 166.078, 244.459, 351.41, 487.021,
659.84, 880.772, 1146.27, 1460.38, 1834.39,
2283.65, 2818.06, 3440.83, 4186.86, 5115.95,
20000
};
// static const float hfamptnm[21] = {
//   0.00, 19.5809, 27.2536, 38.8990, 56.0056,
//   80.7715, 115.848, 164.708, 230.328, 318.081,
//   430.881, 576.298, 759.515, 988.671, 1266.27,
//   1603.48, 2005.61, 2498.42, 3103.36, 3866.94,
//   20000.00
// };

/* AMPT (default) */
static const float hfamptnm[21] = {
0.00, 23.4997, 34.1496, 51.2379, 76.3886,
115.404, 170.374, 249.411, 353.62, 504.845,
701.281, 940.932, 1247.5, 1623.65, 2117.34,
2684.75, 3369.08, 4186.1, 5178.46, 6483.2,
20000
};
// static const float hfamptnm[21] = {
//   0.00, 23.6687, 34.2927, 52.1049, 78.9578,
//   118.669, 178.71, 259.915, 375.493, 527.421,
//   731.578, 982.444, 1288.2, 1670.35, 2155.91,
//   2720.17, 3408.17, 4209.75, 5200.91, 6500.07,
//   20000
// };

/* AMPT (string melting) */
static const float hfamptsm[21] = {
0.00, 26.3165, 39.0218, 58.9913, 88.745,
133.827, 195.186, 283.092, 403.956, 559.506,
763.981, 1025.88, 1343.33, 1729.3, 2201.92,
2744.44, 3412.39, 4190.79, 5144.78, 6488.53,
20000
};
// static const float hfamptsm[21] = {
//   0.00, 26.1925, 38.6599, 58.1971, 87.9247,
//   130.661, 193.275, 280.105, 401.411, 559.744,
//   764.73, 1025.45, 1348.22, 1727.95, 2178.45,
//   2737.85, 3400.03, 4212.76, 5195.21, 6524,
//   20000
// };

int hfbin(float hft) {
  for (int i=0; i<20; ++i) {
    if (hft < hfofficial[i+1])
      return i;
  }

  __builtin_unreachable();
}

const float* hftables[7] = {
  hfofficial, hfeffup, hfeffdown,
  hfepos, hfhydjet, hfamptnm, hfamptsm
};

float hftval(int hfb, int sample) {
  return hftables[sample][hfb];
}

#endif  /* HF_H */
