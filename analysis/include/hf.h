#ifndef HF_H
#define HF_H

// ####### *hiHF_pf* not hiHF ####### //
#define NBIN_CENT 20

static const float hfofficial[21] = {
                                     0., 7.17572, 12.5071, 16.954, 22.3333,
                                     28.551, 35.624, 43.7007, 52.8921, 63.399,
                                     75.4546, 89.3304, 105.32, 123.605, 144.623,
                                     168.728, 196.279, 228.464, 266.531, 316.984,
                                     526.645
};

static const float hfeffdown[21] = {
                                    0., 5.41378, 10.6892, 14.8968, 20,
                                    26.0376, 32.9488, 40.877, 49.8973, 60.2559,
                                    72.1649, 85.8985, 101.839, 120.066, 141.181,
                                    165.43, 193.25, 225.757, 264.359, 315.391,
                                    526.22
};

static const float hfeffup[21] = {
                                  0., 10.4345, 14.3744, 19.1013, 24.6667,
                                  31.0347, 38.2888, 46.5158, 55.8398, 66.4933,
                                  78.6718, 92.6863, 108.708, 127.017, 147.95,
                                  171.893, 199.245, 231.043, 268.62, 318.506,
                                  527.176
};

// EPOS !
static const float hfepos[21] = {
                                 0., 4.06927, 7.16699, 10.2395, 13.9278,
                                 18.2518, 23.3585, 29.431, 36.3991, 44.2816,
                                 53.27, 63.7594, 75.594, 89.8209, 106.143,
                                 124.693, 146.661, 171.446, 201.813, 244.469,
                                 20000
};

// HYDJET
static const float hfhydjet[21] = {
                                   0., 4.63394, 7.90897, 13.9241, 20.0714,
                                   25.8855, 31.6652, 38.1238, 46.0359, 57.0836,
                                   66.6723, 78.6751, 91.8634, 104.259, 119.113,
                                   146.997, 173.399, 204.409, 242.843, 288.713,
                                   20000
};

// AMPT (default)
static const float hfamptnm[21] = {
                                   0., 8.82339, 13.4794, 17.7008, 22.2351,
                                   27.8522, 34.7725, 43.0941, 53.1595, 65.121,
                                   79.4544, 96.1425, 115.889, 138.372, 165.57,
                                   197.985, 235.095, 278.624, 331.512, 403.743,
                                   20000
};

// AMPT (no melting 2) // ! not changed to pf
static const float hfamptnm2[21] = {
                                    0., 16.07, 18.9098, 21.735, 25.0008,
                                    28.9472, 33.817, 39.7154, 46.927, 55.6746,
                                    66.1689, 78.5626, 93.2909, 110.734, 131.678,
                                    156.657, 186.11, 221.301, 264.333, 323.228,
                                    20000
};

// AMPT (string melting) 
static const float hfamptsm[21] = {
                                   0., 8.91817, 13.5791, 17.8254, 22.6448,
                                   28.3919, 35.462, 43.9218, 54.2695, 66.6403,
                                   81.4559, 99.1043, 119.88, 144.381, 173.718,
                                   208.363, 248.856, 296.929, 354.901, 432.464,
                                   20000
};

// HIJING 
static const float hfhijing[21] = {
                                   0., 5.2903, 8.19225, 11.0888, 14.4024,
                                   18.3542, 23.2134, 29.0345, 36.3476, 45.2031,
                                   55.9069, 68.6496, 83.846, 102.068, 124.082,
                                   150.776, 182.776, 221.09, 268.249, 332.318,
                                   20000
};

// Angantyr
static const float hfangantyr[21] = {
                                     0., 9.41829, 15.7825, 23.8756, 33.225,
                                     43.2978, 54.1671, 65.8805, 78.8985, 93.2842,
                                     109.012, 126.346, 144.709, 165.059, 186.653,
                                     210.071, 235.73, 263.94, 296.419, 337.908,
                                     20000
};

const float* hftables[10] = {
                             hfofficial, hfeffup, hfeffdown,
                             hfepos, hfhydjet, hfamptnm, hfamptsm,
                             hfhijing, hfamptnm2, hfangantyr
};

int hfbin(float hft, int ctable=0) {
  for (int i=0; i<20; ++i) {
    if (hft < hftables[ctable][i+1])
      return i;
  }
  return -1;
  // __builtin_unreachable();
}

float hftval(int hfb, int sample) {
  return hftables[sample][hfb];
}

#endif  /* HF_H */
