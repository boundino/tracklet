#ifndef HF_H
#define HF_H

static const float hfofficial[21] = { 
                                     0., 5.5, 11, 16.5, 22,
                                     28.182, 35.2137, 43.1888, 52.178, 62.43,
                                     74.166, 87.6199, 103.141, 120.903, 141.272,
                                     164.728, 191.697, 223.222, 260.858, 310.863,
                                     524
                                     // 20000
};

static const float hfeffdown[21] = {
                                    0., 5, 10, 15, 20,
                                    26.026, 32.914, 40.7943, 49.6561, 59.783,
                                    71.3955, 84.7517, 100.215, 117.89, 138.359,
                                    161.963, 189.126, 220.969, 258.993, 309.474,
                                    524
                                    // 20000
};

static const float hfeffup[21] = {
                                  0., 5.83333, 11.6667, 17.5, 23.3333,
                                  29.5971, 36.7238, 44.7843, 53.8438, 64.1654,
                                  75.9727, 89.5143, 105.035, 122.795, 143.141,
                                  166.518, 193.331, 224.706, 262.052, 311.749,
                                  524
                                  // 20000
};

// EPOS !
static const float hfepos[21] = {
                                 0., 14.5659, 17.5652, 20.6978, 24.2671,
                                 28.631, 33.8486, 39.978, 46.9258, 54.9761,
                                 64.0459, 74.8013, 87.032, 101.373, 118.042,
                                 137.344, 159.06, 184.623, 215.097, 257.699,
                                 20000
};

// HYDJET
static const float hfhydjet[21] = {
                                   0., 15.2948, 19.0882, 23.0596, 27.1487,
                                   31.9133, 36.8627, 42.2459, 49.4129, 57.3735,
                                   67.2572, 78.1872, 93.0848, 110.337, 130.362,
                                   155.882, 186.201, 219.645, 250.418, 306.251,
                                   20000
};

// AMPT (default)
static const float hfamptnm[21] = {
                                   0., 18.1307, 21.8133, 25.2425, 29.195,
                                   34.0879, 40.0585, 47.285, 56.1065, 66.8129,
                                   79.7423, 94.9917, 113.107, 134.809, 160.812,
                                   191.999, 228.69, 272.688, 325.984, 397.565,
                                   20000
};

// AMPT (no melting 2)
static const float hfamptnm2[21] = {
                                    0., 16.07, 18.9098, 21.735, 25.0008,
                                    28.9472, 33.817, 39.7154, 46.927, 55.6746,
                                    66.1689, 78.5626, 93.2909, 110.734, 131.678,
                                    156.657, 186.11, 221.301, 264.333, 323.228,
                                    20000
};

// AMPT (string melting) 
static const float hfamptsm[21] = {
                                   0., 19.3986, 24.143, 28.4943, 33.3238,
                                   39.2252, 46.4356, 55.1338, 65.6764, 78.3967,
                                   93.4604, 111.294, 132.607, 157.79, 187.377,
                                   222.478, 264.062, 312.897, 372.798, 452.24,
                                   20000
};

// HIJING 
static const float hfhijing[21] = {
                                   0., 15.7764, 18.7361, 21.6511, 25.0081,
                                   29.0679, 34.0489, 40.0685, 47.3239, 56.206,
                                   66.9879, 79.9426, 95.446, 114.072, 136.605,
                                   163.303, 195.586, 234.72, 282.704, 348.306,
                                   20000
};

// Angantyr
static const float hfangantyr[21] = {
                                     0., 19.9898, 26.392, 34.8315, 44.5762,
                                     54.8002, 65.7767, 77.6436, 90.959, 105.48,
                                     121.156, 139.087, 158.388, 178.831, 200.961,
                                     225.167, 251.258, 279.902, 312.708, 355.125,
                                     20000
};

int hfbin(float hft) {
  for (int i=0; i<20; ++i) {
    if (hft < hfofficial[i+1])
      return i;
  }

  __builtin_unreachable();
}

const float* hftables[10] = {
                             hfofficial, hfeffup, hfeffdown,
                             hfepos, hfhydjet, hfamptnm, hfamptsm,
                             hfhijing, hfamptnm2, hfangantyr
};

float hftval(int hfb, int sample) {
  return hftables[sample][hfb];
}

#endif  /* HF_H */
